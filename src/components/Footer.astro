---
// Get the current year for copyright
const currentYear = new Date().getFullYear();
---

<footer class="site-footer">
  <div class="footer-container">
    <div class="footer-top">
      <div class="newsletter-section">
      <h3>Subscribe to our Newsletter</h3>
      <form class="newsletter-form" method="POST" action="/api/subscribe">
        <input type="email" name="email" placeholder="Your email address" required>
        <button type="submit" aria-label="Subscribe">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </button>
      </form>
      <p class="newsletter-status" role="status" aria-live="polite" style="margin-top:0.5rem;color:#666;"></p>
      </div>
      <nav class="footer-links" aria-label="Footer policies">
        <a href="https://www.airfryerrecipe.co.uk/privacy-policy">Privacy Policy</a>
        <a href="https://www.airfryerrecipe.co.uk/terms-and-conditions">Terms and Conditions</a>
        <a href="https://www.airfryerrecipe.co.uk/disclaimer">Disclaimer</a>
        <a href="https://www.airfryerrecipe.co.uk/manage-cookies">Manage Cookies</a>
      </nav>
    </div>
    <div class="footer-bottom">
      <div class="copyright">© {currentYear} Air Fryer Recipe. All rights reserved</div>
      <div class="social-links">
        <a href="https://www.linkedin.com/company/107465867/admin/dashboard/" aria-label="LinkedIn">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path>
            <rect x="2" y="9" width="4" height="12"></rect>
            <circle cx="4" cy="4" r="2"></circle>
          </svg>
        </a>
        <a href="https://www.facebook.com/" aria-label="Facebook">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
          </svg>
        </a>
        <a href="https://twitter.com/AirFryerRecipy" aria-label="Twitter">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
          </svg>
        </a>
      </div>
    </div>
  </div>
</footer>

<style>
  .site-footer {
    background-color: #FFF8ED;
    padding: 2rem 0;
    margin-top: 3rem;
    border-top: 1px solid #e5e5e5;
  }

  .footer-container {
    max-width: 1140px;
    width: 90%;
    margin: 0 auto;
    padding: 0 1rem;
  }

  .footer-top {
    display: flex;
    justify-content: flex-start;
    align-items: flex-start; /* align to the same top baseline */
    column-gap: 450px; /* desktop target gap */
    row-gap: 0;
  }

  .newsletter-section {
    margin-bottom: 2rem;
  }

  .newsletter-section h3 {
    font-size: 1rem;
    margin-bottom: 1rem;
    color: #333;
    font-weight: 500;
  }

  .newsletter-form {
    display: flex;
    max-width: 400px;
  }

  .newsletter-form input {
    flex-grow: 1;
    padding: 0.75rem 1rem;
    border: 1px solid #ddd;
    border-radius: 4px 0 0 4px;
    font-size: 0.9rem;
    background-color: white;
    color: #333;
  }

  .newsletter-form input::placeholder {
    color: #999;
  }

  .newsletter-form button {
    background-color: #333;
    color: white;
    border: none;
    border-radius: 0 4px 4px 0;
    padding: 0 1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s ease;
    width: 44px;
  }

  .newsletter-form button:hover {
    background-color: #555;
  }

  .newsletter-status {
    min-height: 1.25rem;
    font-size: 0.9rem;
  }

  .footer-bottom {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-top: 1.5rem;
    border-top: 1px solid #e5e5e5;
  }

  .copyright {
    font-size: 0.9rem;
    color: #666;
  }

  .social-links {
    display: flex;
    gap: 1.5rem;
  }

  .footer-links {
    display: flex;
    flex-direction: column; /* vertical */
    gap: 0; /* spacing will come from link padding */
    font-family: 'Open Sans', Arial, Helvetica, sans-serif; /* Open Sans preferred */
    font-weight: 400; /* Normal */
    font-size: 16px; /* Size: 16 */
    line-height: 20px; /* Height: 20 */
    align-items: flex-start; /* align to left inside its column */
  }

  .footer-links a {
    color: #333; /* Colour: #333 */
    text-decoration: none;
    padding: 9px 0; /* 9px above and below */
    display: block; /* ensure padding applies to full line */
  }

  .footer-links a:hover {
    color: #111;
    text-decoration: underline;
  }

  .social-links a {
    color: #666;
    transition: color 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .social-links a:hover {
    color: #333;
  }

  @media (max-width: 768px) {
    /* Tablet-first adjustment before mobile */
    @media (max-width: 1024px) {
      .footer-top {
        column-gap: 120px; /* reduce on tablet */
      }
    }

    .footer-top {
      flex-direction: column;
      align-items: stretch;
    }

    .footer-bottom {
      flex-direction: column;
      gap: 1.5rem;
      text-align: center;
    }
    
    .social-links {
      justify-content: center;
    }

    .footer-links {
      margin-left: 0;
      justify-content: center;
      align-items: center;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.querySelector('.newsletter-form');
    const statusEl = document.querySelector('.newsletter-status');
    if (!form || !statusEl) return;

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(form as HTMLFormElement);
      const email = (formData.get('email') as string || '').trim();

      if (!email) {
        (statusEl as HTMLElement).textContent = 'Please enter an email address.';
        (statusEl as HTMLElement).style.color = '#b91c1c';
        return;
      }

      (statusEl as HTMLElement).textContent = 'Submitting…';
      (statusEl as HTMLElement).style.color = '#666';

      try {
        const urlEncoded = new URLSearchParams();
        urlEncoded.set('email', email);
        const endpoint = import.meta.env.PUBLIC_NEWSLETTER_ENDPOINT || '/api/subscribe';
        const res = await fetch(endpoint, {
          method: 'POST',
          headers: {
            'content-type': 'application/x-www-form-urlencoded;charset=UTF-8'
          },
          body: urlEncoded.toString()
        });
        const data = await res.json().catch(() => ({}));
        if (res.ok && data?.ok) {
          (statusEl as HTMLElement).textContent = data?.message || 'Thanks for subscribing!';
          (statusEl as HTMLElement).style.color = '#065f46';
          (form as HTMLFormElement).reset();
        } else {
          (statusEl as HTMLElement).textContent = data?.error || 'Something went wrong. Please try again later.';
          (statusEl as HTMLElement).style.color = '#b91c1c';
        }
      } catch (err) {
        (statusEl as HTMLElement).textContent = 'Network error. Please try again later.';
        (statusEl as HTMLElement).style.color = '#b91c1c';
      }
    });
  });
</script>